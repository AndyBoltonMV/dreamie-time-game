<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="//cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>
    <title>Dreamie Time</title>
</head>
<body>
    <h1>DREAMIE TIME</h2>
    <script>
        let dash;
        let cursors;
        // let meow_audio;
        let isWalking;

        function preload () {
            this.load.spritesheet('idle', './assets/cat-spritesheet.png', {frameWidth: 32, frameHeight: 32})
            this.load.spritesheet('run', './assets/cat-spritesheet.png', {frameWidth: 32, frameHeight: 32})
            this.load.spritesheet('jump', './assets/cat-spritesheet.png', {frameWidth: 32, frameHeight: 32})
            // this.load.audio('meow url')
        }

        function create () {
            dash = this.physics.add.sprite(0, 0, 'idle')
            dash.setScale(2.5)
            //dash.setBounce(0.2)
            dash.setCollideWorldBounds(true)

            cursors = this.input.keyboard.createCursorKeys()
            //meow = this.sound.add('meow')

            this.anims.create({
                key: 'idle',
                frameRate: 10,
                repeat: -1,
                frames: this.anims.generateFrameNumbers('idle', { start: 0, end: 3 })
            })

            this.anims.create({
                key: 'left',
                frameRate: 10,
                repeat: -1,
                frames: this.anims.generateFrameNumbers('run', { start: 32, end: 39 })
            })

            this.anims.create({
                key: 'right',
                frameRate: 10,
                repeat: -1,
                frames: this.anims.generateFrameNumbers('run', { start: 32, end: 39 })
            })

            this.anims.create({
                key: 'up',
                repeat: -1,
                frames: this.anims.generateFrameNumbers('jump', { start: 40, end: 45 }),
                frameRate: 5
            })
        }

        function update () {
            if (cursors.left.isDown) {
                isWalking = true
                dash.setVelocityX(-290)
                dash.flipX = true
                dash.anims.play('left', true)
            } else if (cursors.right.isDown) {
                isWalking = true
                dash.flipX = false
                dash.setVelocityX(290)
                dash.anims.play('right', true)
            } else if(cursors.up.isDown){
                isWalking= false
                dash.setVelocityY(-290)
                if(dash.flipX===true){
                  dash.setVelocityX(-50)
                }else{
                  dash.setVelocityX(50)
                }
                dash.anims.play('up', true)
            }else {
                isWalking = false
                dash.setVelocityX(0)
                dash.anims.play('idle', true)
            }

            // if(isWalking && !audio_feet.isPlaying) {
            //     audio_feet.play()
            // }

            // if(!isWalking && audio_feet.isPlaying) {
            //     audio_feet.stop()
            // }
        }

        new Phaser.Game({
            type: Phaser.AUTO,
            width: 900,
            height: 250,
            backgroundColor: '#FFF',
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: { y: 300 },
                    debug: false
                }
            },
            scene: { preload, create, update }
        })
    </script>
</body>
</html>
